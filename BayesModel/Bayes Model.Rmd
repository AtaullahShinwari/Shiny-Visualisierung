---
title: "BayesModel"
output: html_document
---

```{r}
#Hier sollte man umschalten kÃ¶nnen zwischen heart undd trueHeart (also bereinigt und nicht bereinigt)
heart <- read.csv(file="/Users/christian.willmann/Desktop/heart.csv")
heart$ID <- seq.int(nrow(heart))
heart<-heart[,c(ncol(heart),1:(ncol(heart)-1))]
heart
trueHeart<-subset(heart, select = -c(ST_Slope))
trueHeart<-subset(trueHeart, select = -c(RestingECG))
trueHeart<-subset(trueHeart, select = -c(RestingBP))
trueHeart<-subset(trueHeart, select = -c(Cholesterol))

trueHeart<-trueHeart[-450,]
trueHeart
```

```{r}
#Hier ein Slider um die Bins zu bestimmen
apply(trueHeart, 2, function(x) any(is.na(x)))
summary(trueHeart)
str(trueHeart)

#Trennen der Variablen von den Ziellabel
heartVariables <- trueHeart[,1:8] # Selecting the first 8 colums as variables
heartVariables

heartDiseasePrediction <- rbind(heart_selected[,8:8],heart_selected[,1:1])# Selecting the last Column as Prediction
heartDiseasePrediction<-t(heartDiseasePrediction)
heartDiseasePrediction<-heartDiseasePrediction[,c(ncol(heartDiseasePrediction),1:(ncol(heartDiseasePrediction)-1))]
colnames(heartDiseasePrediction) <- c("ID", "heartDiseasePrediction")
heartDiseasePrediction

#Changing Age in characters
column <- 2
mini<-min(heartVariables[,column])
maxi<-max(heartVariables[,column])
span<-maxi-mini
breaks<- 10
steps<-span/breaks
bins <- c(mini-1)
for(i in 1:breaks){
    bins <- c(bins,(mini+i*steps))
    }
#DF clearen
bin_names <- c(paste0(mini,"-",mini+steps)) 
for(i in 1:(breaks-1)){
    bin_names <- c(bin_names,paste0(mini+i*steps,"-",mini+(i+1)*steps)) 
    }
bin_names
heartVariables$Age <- cut(heartVariables$Age, breaks = bins, labels = bin_names)
summary(heartVariables$Age)
plot(heartVariables$Age)

column <- 6

mini<-min(heartVariables[,column])
maxi<-max(heartVariables[,column])
span<-maxi-mini
breaks<- 10
steps<-span/breaks
bins <- c(mini-1)
for(i in 1:breaks){
    bins <- c(bins,(mini+i*steps)) 
    }
#DF clearen
bin_names <- c(paste0(mini,"-",mini+steps)) 
for(i in 1:(breaks-1)){
    bin_names <- c(bin_names,paste0(mini+i*steps,"-",mini+(i+1)*steps)) 
    }
bin_names

heartVariables$MaxHR <- cut(heartVariables$MaxHR, breaks = bins, labels = bin_names)
summary(heartVariables$MaxHR)
plot(heartVariables$MaxHR)


column <- 8

mini<-min(heartVariables[,column])
maxi<-max(heartVariables[,column])
span<-maxi-mini
breaks<- 10
steps<-span/breaks
bins <- c(mini-1)
for(i in 1:breaks){
    bins <- c(bins,(mini+i*steps)) 
    }
#DF clearen
bin_names <- c(paste0(mini,"-",mini+steps)) 
for(i in 1:(breaks-1)){
    bin_names <- c(bin_names,paste0(mini+i*steps,"-",mini+(i+1)*steps)) 
    }
bin_names

heartVariables$Oldpeak <- cut(heartVariables$Oldpeak, breaks = bins, labels = bin_names)
summary(heartVariables$Oldpeak)
plot(heartVariables$Oldpeak)

heart

```

```{r setup, include=FALSE}
#Counts & Probabilitys
#install.packages("tibble")
library(tibble)
getProbsStuff<-function(column){
  print(paste("Counts to every feature value of", colnames(trueHeart[x])))
  counts<- table(trueHeart[x])
  print(counts)
  print(paste("Probabilytis to every feature value of", colnames(trueHeart[x])))
  probs<-((table(trueHeart[x])/nrow(trueHeart))*100)
  NOTprobs<-(100-((table(trueHeart[x])/nrow(trueHeart))*100))
  print(probs)
  headers<- names(counts)
  print(headers)
  concs<-data_frame(headers,counts,probs,NOTprobs)
  print(concs)
  return(concs)
}
Age<-getProbsStuff(2)

#WENN EIN FEHLER AM ENDE KOMMT IST DAS EGAL. DADURCH WERDEN DIE TABLE HIER BESSER ANGEZEIGT.
```



```{r}


#install.packages("rpart")
library(rpart)
binary.model <-rpart(HeartDisease ~ ., data = trueHeart, cp = .02)
plot(binary.model)


  #plot(concs,uniform= T, compress=T,branch=0,7)

```
```{r}
survived <- rpart(HeartDisease ~ ., data = ptitanic, cp = .02)
rpart.plot(survived, type = 3, clip.right.labs = FALSE, branch = .3, under = TRUE)
rpart.rules(survived, cover = TRUE)
```
 
 
 

<!-- ```{r cars} -->
<!-- #Trennen der Variablen von den Ziellabel -->
<!-- #TRAIN TEST SPLIT!!!!!!!!!!!!! -->
<!-- heartVariables <- heart[,1:12] # Selecting the first 13 colums as variables -->
<!-- heartVariables -->

<!-- heartDiseasePrediction <- rbind(heart[,13:13],heart[,1:1])# Selecting the last Column as Prediction -->
<!-- heartDiseasePrediction<-t(heartDiseasePrediction) -->
<!-- heartDiseasePrediction<-heartDiseasePrediction[,c(ncol(heartDiseasePrediction),1:(ncol(heartDiseasePrediction)-1))] -->
<!-- colnames(heartDiseasePrediction) <- c("ID", "heartDiseasePrediction") -->
<!-- heartDiseasePrediction -->

<!-- ``` -->



<!-- ```{r pressure, echo=FALSE} -->
<!-- plot(pressure) -->
<!-- ``` -->

